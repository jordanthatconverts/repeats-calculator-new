<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RepEats Revenue Calculator</title>
  <style>
    :root {
      --bg: #0b0d10;
      --card: #11151a;
      --muted: #9fb0c3;
      --text: #e8edf4;
      --brand: #7c5cff;
      --brand2: #0065a8;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background: linear-gradient(180deg, #0b0d10, #0e1217);
      color: var(--text);
      font: 400 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Inter, sans-serif;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 32px;
    }

    h1 {
      margin: 0 0 16px;
      font-size: 28px;
    }

    h2 {
      margin: 0 0 12px;
      font-size: 20px;
    }

    p {
      margin: 0 0 20px;
      color: var(--muted);
    }

    .grid {
      display: grid;
      grid-gap: 20px;
    }

    @media (min-width: 900px) {
      .grid-cols-2 {
        grid-template-columns: 1fr 1fr;
      }
    }

    .card {
      background: var(--card);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
      overflow-x: auto;
    }

    label {
      font-size: 14px;
      display: block;
      margin-bottom: 6px;
    }

    input[type="number"], input[type="text"] {
      width: 100%;
      min-width: 80px;
      padding: 8px 10px;
      font-size: 14px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 6px;
      background: #0f1318;
      color: var(--text);
      margin-bottom: 12px;
    }

    button {
      background: linear-gradient(90deg, var(--brand), var(--brand2));
      border: none;
      border-radius: 8px;
      padding: 10px 16px;
      color: white;
      font-weight: 600;
      cursor: pointer;
      margin-top: 8px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }

    th, td {
      padding: 8px 12px;
      text-align: right;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }

    th:first-child, td:first-child {
      text-align: left;
    }

    .results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
      margin-top: 20px;
    }

    .kpi {
      background: #0f1318;
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 10px;
      padding: 12px;
      text-align: center;
    }

    .kpi h3 {
      margin: 0 0 8px;
      font-size: 16px;
      font-weight: 500;
      color: var(--muted);
    }

    .kpi p {
      margin: 0;
      font-size: 18px;
      font-weight: 600;
      color: var(--text);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>RepEats Revenue Calculator</h1>
      <p>Set accounts, posting volume, views, CTR & CVR. Add/remove offers freely — we’ll normalise the mix and compute clicks, orders, revenue, and £/1,000 views.</p>
    </header>

    <div class="grid grid-cols-2">
      <!-- Inputs -->
      <section class="card">
        <h2>Inputs</h2>
        <label>Active Accounts Posting</label>
        <input id="accounts" type="number" min="0" step="1" value="6">

        <label>Posts per Month (per account)</label>
        <input id="ppm" type="number" min="0" step="1" value="60">

        <label>Views per Post</label>
        <input id="views" type="number" min="0" step="100" value="10000">

        <label>Total Monthly Views (override)</label>
        <input id="override" type="number" min="0" step="1000" value="0">

        <label>CTR (decimal or %)</label>
        <input id="ctr" type="number" step="0.001" value="0.01">

        <label>CVR (decimal or %)</label>
        <input id="cvr" type="number" step="0.001" value="0.02">

        <button onclick="resetInputs()">Reset</button>
      </section>

      <!-- Offers -->
      <section class="card">
        <h2>Offers (Add / Remove freely)</h2>
        <div id="offers"></div>
        <button onclick="addOffer()">+ Add Offer</button>
      </section>
    </div>

    <!-- Results -->
    <section class="card" style="margin-top:20px;">
      <h2>Results</h2>
      <div class="results-grid">
        <div class="kpi"><h3>Total Posts / Month</h3><p id="res-posts">-</p></div>
        <div class="kpi"><h3>Total Monthly Views</h3><p id="res-views">-</p></div>
        <div class="kpi"><h3>Clicks</h3><p id="res-clicks">-</p></div>
        <div class="kpi"><h3>Orders</h3><p id="res-orders">-</p></div>
        <div class="kpi"><h3>Blended AOV</h3><p id="res-aov">-</p></div>
        <div class="kpi"><h3>£ per 1,000 Views</h3><p id="res-rpm">-</p></div>
        <div class="kpi"><h3>Revenue (Total)</h3><p id="res-rev">-</p></div>
      </div>

      <table id="offerTable"></table>
    </section>
  </div>

  <script>
    let offers = [
      { name: "Offer 1 — BOGO", aov: 10, mix: 35 },
      { name: "Offer 2 — Bundle Builder", aov: 28, mix: 40 },
      { name: "Offer 3 — 3-for-£25", aov: 25, mix: 25 }
    ];

    function addOffer() {
      offers.push({ name: "New Offer", aov: 20, mix: 0 });
      renderOffers();
      calculate();
    }

    function deleteOffer(i) {
      offers.splice(i, 1);
      renderOffers();
      calculate();
    }

    function renderOffers() {
      let container = document.getElementById("offers");
      container.innerHTML = "";
      offers.forEach((o, i) => {
        container.innerHTML += `
          <div style="margin-bottom:10px;">
            <input type="text" value="${o.name}" onchange="offers[${i}].name=this.value">
            <input type="number" value="${o.aov}" onchange="offers[${i}].aov=parseFloat(this.value)">
            <input type="number" value="${o.mix}" onchange="offers[${i}].mix=parseFloat(this.value)">
            <button onclick="deleteOffer(${i})">Delete</button>
          </div>
        `;
      });
    }

    function calculate() {
      let accounts = parseFloat(document.getElementById("accounts").value) || 0;
      let ppm = parseFloat(document.getElementById("ppm").value) || 0;
      let views = parseFloat(document.getElementById("views").value) || 0;
      let override = parseFloat(document.getElementById("override").value) || 0;
      let ctr = parseFloat(document.getElementById("ctr").value) || 0;
      let cvr = parseFloat(document.getElementById("cvr").value) || 0;

      if (ctr > 1) ctr = ctr / 100;
      if (cvr > 1) cvr = cvr / 100;

      let posts = accounts * ppm;
      let monthlyViews = override > 0 ? override : posts * views;
      let clicks = monthlyViews * ctr;
      let orders = clicks * cvr;

      let totalMix = offers.reduce((sum, o) => sum + (o.mix || 0), 0) || 1;
      let normalised = offers.map(o => ({
        ...o,
        mix: (o.mix || 0) / totalMix
      }));

      let blendedAOV = normalised.reduce((sum, o) => sum + o.aov * o.mix, 0);
      let revenue = orders * blendedAOV;
      let rpm = monthlyViews > 0 ? (revenue / monthlyViews) * 1000 : 0;

      document.getElementById("res-posts").innerText = posts.toLocaleString();
      document.getElementById("res-views").innerText = monthlyViews.toLocaleString();
      document.getElementById("res-clicks").innerText = clicks.toLocaleString();
      document.getElementById("res-orders").innerText = orders.toFixed(2);
      document.getElementById("res-aov").innerText = "£" + blendedAOV.toFixed(2);
      document.getElementById("res-rpm").innerText = "£" + rpm.toFixed(2);
      document.getElementById("res-rev").innerText = "£" + revenue.toLocaleString();

      let table = document.getElementById("offerTable");
      table.innerHTML = `<tr><th>Offer</th><th>Mix %</th><th>Orders</th><th>AOV (£)</th><th>Revenue</th></tr>`;
      normalised.forEach(o => {
        let allocOrders = orders * o.mix;
        let rev = allocOrders * o.aov;
        table.innerHTML += `<tr>
          <td>${o.name}</td>
          <td>${(o.mix * 100).toFixed(1)}%</td>
          <td>${allocOrders.toFixed(1)}</td>
          <td>£${o.aov.toFixed(2)}</td>
          <td>£${rev.toFixed(2)}</td>
        </tr>`;
      });
    }

    function resetInputs() {
      document.getElementById("accounts").value = 6;
      document.getElementById("ppm").value = 60;
      document.getElementById("views").value = 10000;
      document.getElementById("override").value = 0;
      document.getElementById("ctr").value = 0.01;
      document.getElementById("cvr").value = 0.02;
      calculate();
    }

    renderOffers();
    calculate();
  </script>
</body>
</html>
